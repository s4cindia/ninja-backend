In `@src/services/pdf/acr-export.service.ts`:
- Around line 331-357: The CONFORMANCE_COLORS lookup can return undefined for
unexpected result.conformance values, causing shading.fill to be undefined;
update the mapping usage in the dataRows creation (where CONFORMANCE_COLORS is
accessed for each result) to fall back to a safe default color (e.g., a
DEFAULT_CONFORMANCE_COLOR or CONFORMANCE_COLORS.UNKNOWN) before building the
TableCell shading, and use that fallback for fill (or omit shading) so
TableCell({ shading: { fill: ... } }) never receives undefined.

In `@src/services/pdf/pdf-comprehensive-parser.service.test.ts`:
- Around line 220-226: The mock object assigned to mockParsedPdf does not fully
satisfy ParsedPDF (structure.pages typed as never[]), causing the type assertion
to fail; fix by creating a fully compatible mock shape for ParsedPDF: populate
structure.pages with properly typed page entries (or cast the whole object via
unknown) and ensure pdfLibDoc and pdfjsDoc are either proper stubs matching
PDFDocument/PDFDocumentProxy or replaced with typed fakes; update the mock in
the test (mockParsedPdf) so its structure.pages and other fields match ParsedPDF
instead of using an empty literal that yields never[].
- Around line 316-322: The mockParsedPdf object is using inline "as unknown as
PDFDocument" assertions on pdfLibDoc and pdfjsDoc which triggers the same
TypeScript warning as the file-based cleanup test; fix it by applying the same
pattern used in that test: remove the per-field double-casts and either (a) make
pdfLibDoc and pdfjsDoc plain empty objects typed via a single broad cast (e.g.,
pdfLibDoc: {} as any, pdfjsDoc: {} as any) and keep the final "as ParsedPDF"
cast, or (b) wrap the entire mock object with "as unknown as ParsedPDF" instead
of casting the individual fieldsâ€”update mockParsedPdf accordingly (reference
symbol: mockParsedPdf and type ParsedPDF, and the fields pdfLibDoc and
pdfjsDoc).